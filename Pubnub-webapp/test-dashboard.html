<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <link rel="icon" type="image/png" href="assets/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>

    <title>PubNub Real-Time Dashboard by Ayush Choukse</title>

    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport'/>
    <meta name="viewport" content="width=device-width"/>


    <!-- Bootstrap core CSS     -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet"/>


    <!-- Animation library for notifications   -->
    <link href="assets/css/animate.min.css" rel="stylesheet"/>

    <!--  Light Bootstrap Table core CSS    -->
    <link href="assets/css/light-bootstrap-dashboard.css" rel="stylesheet"/>


    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="assets/css/demo.css" rel="stylesheet"/>


    <link href="assets/css/style.css" rel="stylesheet" type="text/css"/>
    <script src="https://cdn.pubnub.com/pubnub.min.js"></script>
    <script type="text/javascript" src="assets/js/eon.js"></script>
    <link href="assets/css/eon.css" rel="stylesheet"/>

    <!--<script type="text/javascript" src="//pubnub.github.io/eon/v/eon/0.0.9/eon.js" > </script>-->
    <!--<link type="text/css" rel="stylesheet" href="//pubnub.github.io/eon/v/eon/0.0.9/eon.css"/>-->


    <!--<script type="text/javascript" src="//pubnub.github.io/eon/v/eon/0.0.10/eon.js"></script>-->
    <!--<link type="text/css" rel="stylesheet" href="//pubnub.github.io/eon/v/eon/0.0.10/eon.css"/>-->

    <script type="text/javascript">
        var PUBNUB = PUBNUB.init({
            publish_key: 'pub-c-96f9cabb-5663-43c5-a726-44a25484873c',
            subscribe_key: 'sub-c-829abab8-fc6d-11e5-8cfb-0619f8945a4f'
        });</script>

    <!--     Fonts and icons     -->

    <link href="assets/css/pe-icon-7-stroke.css" rel="stylesheet"/>

</head>
<body>
<style>

</style>
<div class="wrapper">
    <div class="sidebar" data-color="red" style="background-color: #000000">

        <!--

            Tip 1: you can change the color of the sidebar using: data-color="blue | azure | green | orange | red | purple"
            Tip 2: you can also add an image using data-image tag

        -->

        <div class="sidebar-wrapper">
            <div class="logo">
                <h4> Pubnub <br /> Home Automation <br /> Ayush Choukse</h4>
            </div>

            <ul class="nav">
                <li>
                    <a href="realtime-dashboard.html">
                        <i class="pe-7s-graph"></i>
                        <p>Real-Time Dashboard</p>
                    </a>
                </li>
                <li class="active">
                    <a href="test-dashboard.html">
                        <i class="pe-7s-user"></i>
                        <p>Test Data Dashboard</p>
                    </a>
                </li>

            </ul>
        </div>
    </div>

    <div class="main-panel" style="overflow: auto">

        <div class="content">
            <div class="bulb-border" align="center">
                <section class="panel" style="background:transparent;">
                    <header class="panel-heading" style="font-weight: bold; font-size: medium;background-color: transparent">
                        Live Light State
                    </header>
                 </section>
                <div class="row">
                    <div class="col-md-2">
                        <div id="light1" class="bulb" style="float: left"><img class="bulb"
                                                                               src="assets/img/bulb_PNG1239.png"></div>
                        <div class="bulb-name">Family Couch E</div>
                    </div>

                    <div class="col-md-2">
                        <div id="light2" class="bulb" style="float: left"><img class="bulb"
                                                                               src="assets/img/bulb_PNG1239.png"></div>
                        <div class="bulb-name">Horse Picture</div>
                    </div>
                    <div class="col-md-2">
                        <div id="light3" class="bulb" style="float: left"><img class="bulb"
                                                                               src="assets/img/bulb_PNG1239.png"></div>
                        <div class="bulb-name">Aspen Light</div>
                    </div>
                    <div class="col-md-2">
                        <div id="light4" class="bulb" style="float: left"><img class="bulb"
                                                                               src="assets/img/bulb_PNG1239.png"></div>
                        <div class="bulb-name">Family W</div>
                    </div>
                    <div class="col-md-2">
                        <div id="light5" class="bulb" style="float: left"><img class="bulb"
                                                                               src="assets/img/bulb_PNG1239.png"></div>
                        <div class="bulb-name">Family Couch W</div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-2">
                        <div id="light6" class="bulb" style="float: left"><img class="bulb"
                                                                               src="assets/img/bulb_PNG1239.png"></div>
                        <div class="bulb-name">Family TV</div>
                    </div>

                    <div class="col-md-2">
                        <div id="light7" class="bulb" style="float: left"><img class="bulb"
                                                                               src="assets/img/bulb_PNG1239.png"></div>
                        <div class="bulb-name">Round Room E</div>
                    </div>
                    <div class="col-md-2">
                        <div id="light8" class="bulb" style="float: left"><img class="bulb"
                                                                               src="assets/img/bulb_PNG1239.png"></div>
                        <div class="bulb-name">Round Room NW</div>
                    </div>
                    <div class="col-md-2">
                        <div id="light9" class="bulb" style="float: left"><img class="bulb"
                                                                               src="assets/img/bulb_PNG1239.png"></div>
                        <div class="bulb-name">Round Room SW</div>
                    </div>
                    <div class="col-md-2">
                        <div id="light10" class="bulb" style="float: left"><img class="bulb"
                                                                                src="assets/img/bulb_PNG1239.png"></div>
                        <div class="bulb-name">Family Couch W</div>
                    </div>
                </div>

            </div>

            <div class="content" align="center">
            <section class="panel" style="alignment: center;background:transparent;">
                <header class="panel-heading" style="font-weight: bold; font-size: medium;background:transparent;">
                    Live Temperature Update
                </header>
            </section>
            <div id="chart" style="margin-top: 50px"></div>
            </div>

            <div class="container-fluid" align="center">
                <div class="row">
                    <section class="panel" style="background:transparent;">
                        <header class="panel-heading" style="font-weight: bold; font-size: medium ;background-color: transparent">
                            Data Feed
                        </header>

                        <div class="panel-body streams-message-output" id="noti-box" >
                            <ul id="listView1">
                            </ul>
                        </div>
                    </section>

                </div>


            </div>
        </div>
    </div>


    <footer class="footer">

    </footer>

</div>
</div>


</body>

<!--   Core JS Files   -->
<script src="assets/js/jquery-1.10.2.js" type="text/javascript"></script>
<script src="assets/js/bootstrap.min.js" type="text/javascript"></script>

<!--  Checkbox, Radio & Switch Plugins -->
<script src="assets/js/bootstrap-checkbox-radio-switch.js"></script>

<!--  Charts Plugin -->


<!--  Notifications Plugin    -->
<script src="assets/js/bootstrap-notify.js"></script>

<!--  Google Maps Plugin    -->


<!-- Light Bootstrap Table Core javascript and methods for Demo purpose -->
<script src="assets/js/light-bootstrap-dashboard.js"></script>

<!-- Light Bootstrap Table DEMO methods, don't include it in your project! -->
<script src="assets/js/demo.js"></script>


<script>

</script>

<script type="text/javascript">


    PUBNUB.init({
        subscribe_key: 'sub-c-829abab8-fc6d-11e5-8cfb-0619f8945a4f'
    }).subscribe({
        channel: 'pubnub_test_topic',
        message: function (msg1) {
            var msg = msg1;
            //console.log(msg);
            var message = JSON.parse(msg);
            var light = message.name;
            var deviceId = message.deviceId;
            if (light) {
                var state = message.state;
                if (state == "Red") {
                    $('#listView1').prepend('<tr><td><div class="message" style="font-weight: bold;">' + Date("dddd, mmmm dS, yyyy, h:MM:ss TT") + ' : </div></td><td class="packet" style="font-weight: bold ; color: #a30113; font-size: medium">' + msg + '</td></tr>');
                } else {
                    $('#listView1').prepend('<tr><td><div class="message" style="font-weight: bold;">' + Date("dddd, mmmm dS, yyyy, h:MM:ss TT") + ' : </div></td><td class="packet" style="font-weight: bold ; color: #00d532; font-size: medium">' + msg + '</td></tr>');
                }
            } else {
                $('#listView1').prepend('<tr><td><div class="message" style="font-weight: bold;">' + Date("dddd, mmmm dS, yyyy, h:MM:ss TT") + ' : </div></td><td class="packet" style="font-weight: bold ; color: #fa0; font-size: medium">' + msg + '</td></tr>');
            }

            onMessageArrived(msg);
        }
    });
    var temp1 = 0;
    var temp2 = 0;
    var temp3 = 0;
    var msg = 0;
    function onMessageArrived(message) {
        //console.log(message.payloadString);
        msg = JSON.parse(message);
        var light = msg.name;
        var deviceId = msg.deviceId;

        //console.log(message);
        //console.log(light)

        //console.log(newDiv)
        if (light) {

            switch (light) {
                case "Family Couch E":
                    update("light1", msg);
                    break;
                case "Horse Picture":
                    update("light2", msg);
                    break;
                case "Aspen":
                    update("light3", msg);
                    break;
                case "Family W":
                    update("light4", msg);
                    break;
                case "Family Couch W":
                    update("light5", msg);
                    break;
                case "Family TV":
                    update("light6", msg);
                    break;
                case "Round Room E":
                    update("light7", msg);
                    break;
                case "Round Room NW":
                    update("light8", msg);
                    break;
                case "Round Room SW":
                    update("light9", msg);
                    break;
                case "Family E":
                    update("light10", msg);
                    break;
            }

        } else if (deviceId) {

            switch (deviceId) {
                case "28:db:b1:1f:06:00:00:d3":
                    temp1 = msg.celciusTemperature;
                    break;
                case "28:26:1c:60:07:00:00:ad":
                    temp2 = msg.celciusTemperature;
                    break;
                case "28:ff:2c:31:44:04:00:c2":
                    temp3 = msg.celciusTemperature;
                    break;
            }
        }


    }

    function update(name, msg) {
        var newDiv = document.getElementById(name);
        var elem = document.createElement("img");
        elem.setAttribute("src", "assets/img/bulb_PNG1239.png");
        elem.setAttribute("class", "bulb");
        newDiv.appendChild(elem);

        var state = msg.state;
        //console.log("state : "+state)
        if (state == "Red") {
            //state='bulb_lightStainless.png';
            elem.setAttribute("src", "assets/img/bulb_PNG1243.png");
            elem.setAttribute("class", "bulb");
        }
        else {
            //state='bulb_light.png';
            elem.setAttribute("src", "assets/img/bulb_PNG1244.png");
            elem.setAttribute("class", "bulb");
        }

        while (newDiv.hasChildNodes()) {
            newDiv.removeChild(newDiv.lastChild);
        }
        newDiv.appendChild(elem);
    }


    eon.chart({

        channel: 'c3-spline',
        limit: 40,
        flow: true,
        generate: {
            bindto: '#chart',
            data: {
                type: 'spline',
                labels: true,

            },
            axis: {
                x: {
                    label: {
                        text: 'Timestamp',
                        position: 'outer-middle',
                    }
                },
                y: {
                    ticke: 1,
                    label: {
                        text: 'Temperature °C',
                        position: 'outer-middle'
                    }
                }
            }
        }


    });

    eon.chart({
        channel: 'thermostat1',
        generate: {
            bindto: '#thermostat1',
            data: {
                type: 'gauge',

            },
            gauge: {
                min: 0,
                max: 100,
                units: "°C"
            },
            color: {
                pattern: ['#FF0000', '#F6C600', '#60B044'],
                threshold: {
                    unit: '°C',
                    values: [15, 20, 30]
                }
            }
        }
    });
    eon.chart({
        channel: 'thermostat2',
        generate: {
            bindto: '#thermostat2',
            data: {
                type: 'gauge',
            },
            gauge: {
                min: 0,
                max: 100
            },
            color: {
                pattern: ['#FF0000', '#F6C600', '#60B044'],
                threshold: {
                    values: [15, 20, 30]
                }
            }
        }
    });
    eon.chart({
        channel: 'thermostat3',
        generate: {
            bindto: '#thermostat3',
            data: {
                type: 'gauge',
            },
            gauge: {
                min: 0,
                max: 100
            },
            color: {
                pattern: ['#FF0000', '#F6C600', '#60B044'],
                threshold: {
                    values: [15, 20, 30]
                }
            }
        }
    });
    setInterval(function () {
        PUBNUB.publish({
            channel: 'c3-spline',
            message: {
                "eon": {
                    'Thermostat 1': temp1,
                    'Thermostat 2': temp2,
                    'Thermostat 3': temp3
                }
            }
        });

    }, 1000);


</script>

</html>



